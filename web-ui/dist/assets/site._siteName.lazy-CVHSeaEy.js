import{B as A,e as X,f as Be,j as t,_ as Y,g as Me,R as C,r as p,h as Le,i as re,S as T,c as x,C as D,H as u,L as ne,k as be,l as Ke,m as We,n as ze,d as Ve}from"./index-BAcZo2i6.js";import{B as E,S as b,I as w,E as Ye,a as Ue,b as qe,c as Je,d as Ge,e as Ze,f as Qe,g as Xe}from"./env_variables-DBgTPTRJ.js";import{A as et}from"./arguments-90i_LMyj.js";const tt={[A.Running]:"Stop site",[A.Stopped]:"Start site",[A.Faulty]:"Start site",[A.Stopping]:"Start site",[A.Starting]:"Stop site",[A.Remote]:"Remote"},nt=({hostedProcess:e,remoteSite:o})=>{var d,n,g,j;const{startSite:r,stopSite:a}=X(),s=Be(),i=e?(n=(d=s.data)==null?void 0:d.find(v=>v.hostname===e.host_name))==null?void 0:n.state:o?(j=(g=s.data)==null?void 0:g.find(v=>v.hostname===o.host_name))==null?void 0:j.state:A.Remote;return t.jsx(t.Fragment,{children:t.jsxs("div",{style:{fontSize:".8rem",display:"flex",flexDirection:"column",gap:"10px",maxWidth:"750px"},children:[t.jsxs("div",{className:"pb-2 select-none flex items-center justify-between border-b border-gray-500",title:`${i}`,children:[t.jsx("p",{style:{textTransform:"uppercase",fontWeight:"bold"},children:"status:"}),t.jsx("p",{style:{display:"flex",alignItems:"center",gap:"5px"},children:i})]}),t.jsx("div",{style:{marginTop:"10px"},children:i!==A.Remote&&t.jsx(E,{style:{maxWidth:"max-content"},disabled:r.isPending||a.isPending,dangerButton:i===A.Running,onClick:async()=>{e&&(i===A.Running?Y.promise(a.mutateAsync({hostname:e.host_name}),{loading:"Stopping site..",success:"Site stopped!",error:v=>`Failed to stop site: ${v}`}):Y.promise(r.mutateAsync({hostname:e.host_name}),{loading:"Starting site..",success:"Site started!",error:v=>`Failed to start site: ${v}`}))},children:tt[i]})})]})})};var ge={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var o={}.hasOwnProperty;function r(){for(var i="",d=0;d<arguments.length;d++){var n=arguments[d];n&&(i=s(i,a(n)))}return i}function a(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return r.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var d="";for(var n in i)o.call(i,n)&&i[n]&&(d=s(d,n));return d}function s(i,d){return d?i?i+" "+d:i+d:i}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(ge);var ot=ge.exports;const W=Me(ot);function rt(e){if(Array.isArray(e)){for(var o=0,r=Array(e.length);o<e.length;o++)r[o]=e[o];return r}else return Array.from(e)}var ae=!1;if(typeof window<"u"){var xe={get passive(){ae=!0}};window.addEventListener("testPassive",null,xe),window.removeEventListener("testPassive",null,xe)}var ye=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),P=[],G=!1,Se=-1,z=void 0,V=void 0,we=function(o){return P.some(function(r){return!!(r.options.allowTouchMove&&r.options.allowTouchMove(o))})},Z=function(o){var r=o||window.event;return we(r.target)||r.touches.length>1?!0:(r.preventDefault&&r.preventDefault(),!1)},at=function(o){if(V===void 0){var r=!!o&&o.reserveScrollBarGap===!0,a=window.innerWidth-document.documentElement.clientWidth;r&&a>0&&(V=document.body.style.paddingRight,document.body.style.paddingRight=a+"px")}z===void 0&&(z=document.body.style.overflow,document.body.style.overflow="hidden")},st=function(){V!==void 0&&(document.body.style.paddingRight=V,V=void 0),z!==void 0&&(document.body.style.overflow=z,z=void 0)},lt=function(o){return o?o.scrollHeight-o.scrollTop<=o.clientHeight:!1},it=function(o,r){var a=o.targetTouches[0].clientY-Se;return we(o.target)?!1:r&&r.scrollTop===0&&a>0||lt(r)&&a<0?Z(o):(o.stopPropagation(),!0)},dt=function(o,r){if(!o){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!P.some(function(s){return s.targetElement===o})){var a={targetElement:o,options:r||{}};P=[].concat(rt(P),[a]),ye?(o.ontouchstart=function(s){s.targetTouches.length===1&&(Se=s.targetTouches[0].clientY)},o.ontouchmove=function(s){s.targetTouches.length===1&&it(s,o)},G||(document.addEventListener("touchmove",Z,ae?{passive:!1}:void 0),G=!0)):at(r)}},ct=function(o){if(!o){console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");return}P=P.filter(function(r){return r.targetElement!==o}),ye?(o.ontouchstart=null,o.ontouchmove=null,G&&P.length===0&&(document.removeEventListener("touchmove",Z,ae?{passive:!1}:void 0),G=!1)):P.length||st()};function ut(e=null){let[o,r]=C.useState(e);const{current:a}=C.useRef({current:o});return Object.defineProperty(a,"current",{get:()=>o,set:s=>{Object.is(o,s)||(o=s,r(s))}}),a}function mt(e,o={isStateful:!0}){const r=ut(null),a=p.useRef(null),s=o.isStateful?r:a;return C.useEffect(()=>{!e||(typeof e=="function"?e(s.current):e.current=s.current)}),s}function Q(){return Q=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Q.apply(this,arguments)}var ht=function(o){var r=o.classes,a=o.classNames,s=o.styles,i=o.id,d=o.closeIcon,n=o.onClick;return C.createElement("button",{id:i,className:W(r.closeButton,a==null?void 0:a.closeButton),style:s==null?void 0:s.closeButton,onClick:n,"data-testid":"close-button"},d||C.createElement("svg",{className:a==null?void 0:a.closeIcon,style:s==null?void 0:s.closeIcon,width:28,height:28,viewBox:"0 0 36 36","data-testid":"close-icon"},C.createElement("path",{d:"M28.5 9.62L26.38 7.5 18 15.88 9.62 7.5 7.5 9.62 15.88 18 7.5 26.38l2.12 2.12L18 20.12l8.38 8.38 2.12-2.12L20.12 18z"})))},J=typeof window<"u",je=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'];function ft(e){return e.offsetParent===null||getComputedStyle(e).visibility==="hidden"}function pt(e,o){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===o)return e[r]}function vt(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!0;var o=e.form||e.ownerDocument,r=o.querySelectorAll('input[type="radio"][name="'+e.name+'"]'),a=pt(r,e.form);return a===e||a===void 0&&r[0]===e}function _e(e){for(var o=document.activeElement,r=e.querySelectorAll(je.join(",")),a=[],s=0;s<r.length;s++){var i=r[s];(o===i||!i.disabled&&bt(i)>-1&&!ft(i)&&vt(i))&&a.push(i)}return a}function xt(e,o){if(!(!e||e.key!=="Tab")){if(!o||!o.contains)return process,!1;if(!o.contains(e.target))return!1;var r=_e(o),a=r[0],s=r[r.length-1];return e.shiftKey&&e.target===a?(s.focus(),e.preventDefault(),!0):!e.shiftKey&&e.target===s?(a.focus(),e.preventDefault(),!0):!1}}function bt(e){var o=parseInt(e.getAttribute("tabindex"),10);return isNaN(o)?gt(e)?0:e.tabIndex:o}function gt(e){return e.getAttribute("contentEditable")}var yt=function(o){var r=o.container,a=o.initialFocusRef,s=p.useRef();return p.useEffect(function(){var i=function(j){r!=null&&r.current&&xt(j,r.current)};if(J&&document.addEventListener("keydown",i),J&&(r!=null&&r.current)){var d=function(){je.findIndex(function(j){var v;return(v=document.activeElement)==null?void 0:v.matches(j)})!==-1&&(s.current=document.activeElement)};if(a)d(),requestAnimationFrame(function(){var g;(g=a.current)==null||g.focus()});else{var n=_e(r.current);n[0]&&(d(),n[0].focus())}}return function(){if(J){var g;document.removeEventListener("keydown",i),(g=s.current)==null||g.focus()}}},[r,a]),null},M=[],oe={add:function(o){M.push(o)},remove:function(o){M=M.filter(function(r){return r!==o})},isTopModal:function(o){return!!M.length&&M[M.length-1]===o}};function St(e,o){p.useEffect(function(){return o&&oe.add(e),function(){oe.remove(e)}},[o,e])}var wt=function(o,r,a,s,i){var d=p.useRef(null);p.useEffect(function(){return r&&o.current&&s&&(d.current=o.current,dt(o.current,{reserveScrollBarGap:i})),function(){d.current&&(ct(d.current),d.current=null)}},[r,a,o,s,i])},k={root:"react-responsive-modal-root",overlay:"react-responsive-modal-overlay",overlayAnimationIn:"react-responsive-modal-overlay-in",overlayAnimationOut:"react-responsive-modal-overlay-out",modalContainer:"react-responsive-modal-container",modalContainerCenter:"react-responsive-modal-containerCenter",modal:"react-responsive-modal-modal",modalAnimationIn:"react-responsive-modal-modal-in",modalAnimationOut:"react-responsive-modal-modal-out",closeButton:"react-responsive-modal-closeButton"},jt=C.forwardRef(function(e,o){var r,a,s,i,d=e.open,n=e.center,g=e.blockScroll,j=g===void 0?!0:g,v=e.closeOnEsc,I=v===void 0?!0:v,c=e.closeOnOverlayClick,y=c===void 0?!0:c,m=e.container,N=e.showCloseIcon,F=N===void 0?!0:N,$=e.closeIconId,h=e.closeIcon,l=e.focusTrapped,f=l===void 0?!0:l,_=e.initialFocusRef,R=_===void 0?void 0:_,se=e.animationDuration,le=se===void 0?300:se,S=e.classNames,O=e.styles,ie=e.role,Te=ie===void 0?"dialog":ie,Ne=e.ariaDescribedby,ke=e.ariaLabelledby,Ae=e.containerId,Oe=e.modalId,ee=e.onClose,de=e.onEscKeyDown,ce=e.onOverlayClick,ue=e.onAnimationEnd,He=e.children,Ee=e.reserveScrollBarGap,me=mt(o),U=p.useRef(null),B=p.useRef(null),H=p.useRef(null);H.current===null&&J&&(H.current=document.createElement("div"));var he=p.useState(!1),L=he[0],fe=he[1];St(U,d),wt(U,d,L,j,Ee);var Ie=function(){H.current&&!m&&!document.body.contains(H.current)&&document.body.appendChild(H.current),document.addEventListener("keydown",pe)},Re=function(){H.current&&!m&&document.body.contains(H.current)&&document.body.removeChild(H.current),document.removeEventListener("keydown",pe)},pe=function(q){q.keyCode!==27||!oe.isTopModal(U)||(de==null||de(q),I&&ee())};p.useEffect(function(){return function(){L&&Re()}},[L]),p.useEffect(function(){d&&!L&&(fe(!0),Ie())},[d]);var De=function(q){if(B.current===null&&(B.current=!0),!B.current){B.current=null;return}ce==null||ce(q),y&&ee(),B.current=null},te=function(){B.current=!1},Pe=function(){d||fe(!1),ue==null||ue()},ve=m||H.current,Fe=d?(r=S==null?void 0:S.overlayAnimationIn)!=null?r:k.overlayAnimationIn:(a=S==null?void 0:S.overlayAnimationOut)!=null?a:k.overlayAnimationOut,$e=d?(s=S==null?void 0:S.modalAnimationIn)!=null?s:k.modalAnimationIn:(i=S==null?void 0:S.modalAnimationOut)!=null?i:k.modalAnimationOut;return L&&ve?Le.createPortal(C.createElement("div",{className:W(k.root,S==null?void 0:S.root),style:O==null?void 0:O.root,"data-testid":"root"},C.createElement("div",{className:W(k.overlay,S==null?void 0:S.overlay),"data-testid":"overlay","aria-hidden":!0,style:Q({animation:Fe+" "+le+"ms"},O==null?void 0:O.overlay)}),C.createElement("div",{ref:U,id:Ae,className:W(k.modalContainer,n&&k.modalContainerCenter,S==null?void 0:S.modalContainer),style:O==null?void 0:O.modalContainer,"data-testid":"modal-container",onClick:De},C.createElement("div",{ref:me,className:W(k.modal,S==null?void 0:S.modal),style:Q({animation:$e+" "+le+"ms"},O==null?void 0:O.modal),onMouseDown:te,onMouseUp:te,onClick:te,onAnimationEnd:Pe,id:Oe,role:Te,"aria-modal":"true","aria-labelledby":ke,"aria-describedby":Ne,"data-testid":"modal",tabIndex:-1},f&&C.createElement(yt,{container:me,initialFocusRef:R}),He,F&&C.createElement(ht,{classes:k,classNames:S,styles:O,closeIcon:h,onClick:ee,id:$})))),ve):null});const Ce=({show:e,onClose:o,title:r,subtitle:a,children:s})=>t.jsx(jt,{showCloseIcon:!1,blockScroll:!1,styles:{modal:{background:"transparent",backdropFilter:"blur(20px)",borderRadius:"5px",border:"1px solid #ffffff22"}},open:e,onClose:o,center:!0,children:t.jsxs("div",{children:[r&&t.jsx("h3",{children:r}),a&&t.jsx("p",{style:{fontSize:".9rem"},children:a}),s]})}),_t=({site:e})=>{var N,F,$,h;const{updateSite:o,deleteSite:r}=X(),[a,s]=p.useState(e.host_name),[i,d]=p.useState(e.port??8080),[n,g]=p.useState(e.dir??void 0),[j,v]=p.useState(e.bin),[I,c]=p.useState(!1),y=re(),m=(l,f)=>{let _=Array.isArray(f)||isNaN(f)===!1?f:`${f}`;Y.promise(o.mutateAsync({hostname:e.host_name,siteSettings:{...e,[l]:_}}),{loading:`Updating settings.. [${e.host_name}]`,success:`Settings updated! [${e.host_name}]`,error:R=>`${R}`})};return t.jsxs("div",{style:{paddingBottom:"50px",maxWidth:"750px"},onSubmit:l=>{l.preventDefault()},children:[t.jsxs(T,{noTopSeparator:!0,children:[t.jsx(x,{title:"Hostname",subTitle:b.hostname_frontend,children:t.jsx(w,{originalValue:e.host_name,onSave:l=>{m("host_name",l)},withSaveButton:!0,value:a,onChange:l=>s(l.target.value)})}),t.jsx(x,{title:"Port",subTitle:b.port,children:t.jsx(w,{originalValue:e.port??8080,withSaveButton:!0,onSave:l=>{m("port",l)},value:i,onChange:l=>{isNaN(Number(l.target.value))||d(Number(l.target.value))}})})]}),t.jsxs(T,{noTopSeparator:!0,children:[t.jsx(x,{title:"Directory",subTitle:b.directory,children:t.jsx(w,{value:n,withSaveButton:!0,originalValue:e.dir??void 0,onSave:l=>{m("dir",l)},onChange:l=>g(l.target.value)})}),t.jsx(x,{title:"Bin",subTitle:b.binary,children:t.jsx(w,{value:j,withSaveButton:!0,originalValue:e.bin,onSave:l=>{m("bin",l)},onChange:l=>v(l.target.value)})})]}),t.jsx(T,{noTopSeparator:!0,children:t.jsx(x,{labelFor:"use_https",rowOnly:!0,title:"HTTPS",subTitle:b.https,children:t.jsx(w,{checked:!!e.https,onChange:()=>{m("https",!e.https)},name:"use_https",id:"use_https",type:"checkbox",style:{width:"20px",height:"20px"}})})}),t.jsx(T,{noTopSeparator:!0,children:t.jsx(x,{labelFor:"auto_start",rowOnly:!0,title:"Auto start",subTitle:b.auto_start,children:t.jsx(w,{id:"auto_start",checked:!!e.auto_start,name:"auto_start",onChange:()=>{m("auto_start",!e.auto_start)},type:"checkbox",style:{width:"20px",height:"20px"}})})}),t.jsxs(T,{noTopSeparator:!0,children:[t.jsx(x,{labelFor:"capture_subdomains",rowOnly:!0,title:"Capture sub-domains",subTitle:b.capture_subdomains,children:t.jsx(w,{onChange:()=>{m("capture_subdomains",!e.capture_subdomains)},checked:!!e.capture_subdomains,type:"checkbox",name:"capture_subdomains",id:"capture_subdomains",style:{width:"20px",height:"20px"}})}),t.jsx(x,{rowOnly:!0,labelFor:"disable_tcp_tunnel",title:"Disable TCP tunnel mode",subTitle:b.disable_tcp_tunnel,children:t.jsx(w,{type:"checkbox",checked:!!e.disable_tcp_tunnel_mode,onChange:()=>{m("disable_tcp_tunnel_mode",!e.disable_tcp_tunnel_mode)},id:"disable_tcp_tunnel",name:"disable_tcp_tunnel",style:{width:"20px",height:"20px"}})}),t.jsx(x,{rowOnly:!0,labelFor:"forward_subdomains",title:"Forward sub-domains",subTitle:b.forward_subdomains,children:t.jsx(w,{type:"checkbox",checked:!!e.forward_subdomains,onChange:()=>{m("forward_subdomains",!e.forward_subdomains)},id:"forward_subdomains",name:"forward_subdomains",style:{width:"20px",height:"20px"}})})]}),t.jsxs(T,{noTopSeparator:!0,noBottomSeparator:!0,children:[t.jsx(x,{title:"H2 Hints",subTitle:b.h2_hint}),t.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",justifyContent:"start"},children:[t.jsx(D,{onClick:()=>{var l;m("hints",(l=e.hints)!=null&&l.includes(u.H2)?e.hints.filter(f=>f!==u.H2):[...e.hints??[],u.H2])},checked:!!((N=e==null?void 0:e.hints)!=null&&N.includes(u.H2)),title:"H2"}),t.jsx(D,{onClick:()=>{var l;m("hints",(l=e.hints)!=null&&l.includes(u.H2C)?e.hints.filter(f=>f!==u.H2C):[...e.hints??[],u.H2C])},checked:!!((F=e==null?void 0:e.hints)!=null&&F.includes(u.H2C)),title:"H2C"}),t.jsx(D,{onClick:()=>{var l;m("hints",(l=e.hints)!=null&&l.includes(u.H2CPK)?e.hints.filter(f=>f!==u.H2CPK):[...e.hints??[],u.H2CPK])},checked:!!(($=e==null?void 0:e.hints)!=null&&$.includes(u.H2CPK)),title:"H2CPK"}),t.jsx(D,{onClick:()=>{var l;m("hints",(l=e.hints)!=null&&l.includes(u.NOH2)?e.hints.filter(f=>f!==u.NOH2):[...e.hints??[],u.NOH2])},checked:!!((h=e==null?void 0:e.hints)!=null&&h.includes(u.NOH2)),title:"NOH2"})]}),t.jsx(x,{title:"Log format",subTitle:b.log_format,children:t.jsxs("select",{className:"text-black rounded pl-3 pr-3",value:e.log_format??ne.Standard,onChange:l=>{m("log_format",l.target.value)},name:"log_format",style:{height:"30px",width:"100%"},children:[t.jsx("option",{value:ne.Standard,children:"Standard"}),t.jsx("option",{value:ne.Dotnet,children:"Dotnet"})]})})]}),t.jsx("div",{style:{marginBottom:"20px"},children:t.jsx(x,{labelFor:"exclude_from_start_all",rowOnly:!0,title:"Exclude from 'start all'",subTitle:b.exclude_from_start_all,children:t.jsx(w,{checked:!!e.exclude_from_start_all,onChange:()=>{m("exclude_from_start_all",!e.exclude_from_start_all)},id:"exclude_from_start_all",type:"checkbox",style:{width:"20px",height:"20px"}})})}),t.jsx(T,{noBottomSeparator:!0,children:t.jsx(x,{vertical:!0,title:"Environment variables",subTitle:b.env_vars,children:t.jsx(Ye,{keys:e.env_vars??[],onRemoveKey:l=>{var f;m("env_vars",(f=e.env_vars)==null?void 0:f.filter(_=>_.key!==l))},onNewKey:(l,f)=>{var _;m("env_vars",[...((_=e.env_vars)==null?void 0:_.filter(R=>R.key!==l.key&&R.key!==f))??[],{key:l.key,value:l.value}])}})})}),t.jsx(T,{noBottomSeparator:!0,noTopSeparator:!0,children:t.jsx(x,{vertical:!0,title:"Arguments",subTitle:b.args,children:t.jsx(et,{onAddArg:(l,f)=>{var _;m("args",[...((_=e.args)==null?void 0:_.filter(R=>R!==f))??[],l])},onRemoveArg:l=>{var f;m("args",[...((f=e.args)==null?void 0:f.filter(_=>_!==l))??[]])},defaultKeys:e.args??[]})})}),t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"end",marginTop:"20px"},children:t.jsx(E,{onClick:()=>{c(!0)},style:{width:"max-content"},dangerButton:!0,children:"Delete site"})}),t.jsx(Ce,{show:I,onClose:()=>c(!1),title:"Delete",subtitle:`Are you sure you want to delete the site '${e.host_name}'?`,children:t.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"10px"},children:[t.jsx(E,{secondary:!0,onClick:()=>c(!1),children:"Cancel"}),t.jsx(E,{onClick:()=>{Y.promise(r.mutateAsync({hostname:e.host_name},{onSuccess:()=>{c(!1),y.navigate({to:"/"})}}),{loading:`Deleting site.. [${e.host_name}]`,success:()=>(y.navigate({to:"/"}),`Site deleted! [${e.host_name}]`),error:l=>`${l}`})},dangerButton:!0,children:"Yes, delete"})]})})]},e.host_name)},Ct=()=>t.jsx("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:t.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 7.757v8.486M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Tt=({site:e,show:o,onClose:r,listIndex:a})=>{var m,N,F,$;const{data:s}=be(),{updateRemoteSite:i}=X(),d=s.find(h=>h.host_name===e.host_name),n=d==null?void 0:d.backends[a],[g,j]=p.useState((n==null?void 0:n.address)??""),[v,I]=p.useState((n==null?void 0:n.port)??8080),c=(n==null?void 0:n.https)??!1,y=({newBackendSettings:h})=>{const l=[...e.backends.slice(0,a),h,...e.backends.slice(a+1)];i.mutateAsync({hostname:e.host_name,siteSettings:{...e,backends:l}})};return n?(console.log("not null, show:",o),t.jsx(Ue,{open:o,onOpenChange:r,children:t.jsxs(qe,{className:"bg-[#242424] border-l-[#ffffff10] w-full",children:[t.jsxs(Je,{className:"text-left",children:[t.jsx(Ge,{className:"text-white",children:"Edit backend"}),t.jsxs(Ze,{children:["Making changes to ",n.address]})]}),t.jsxs(T,{children:[t.jsx(x,{vertical:!0,title:"Address",subTitle:b.hostname_frontend,children:t.jsx(w,{originalValue:n==null?void 0:n.address,onSave:()=>{y({newBackendSettings:{port:n.port,address:g,hints:(n==null?void 0:n.hints)??[],https:c}})},withSaveButton:!0,value:g,onChange:h=>{j(h.target.value)}})}),t.jsx(x,{vertical:!0,title:"Port",subTitle:b.port,children:t.jsx(w,{originalValue:n==null?void 0:n.port,withSaveButton:!0,onSave:()=>{y({newBackendSettings:{port:v,address:n.address,hints:(n==null?void 0:n.hints)??[],https:c}})},value:v,onChange:h=>{isNaN(Number(h.target.value))||I(Number(h.target.value))}})}),t.jsx(x,{labelFor:"use_https",rowOnly:!0,title:"HTTPS",subTitle:b.https,children:t.jsx(w,{checked:c,onChange:()=>{y({newBackendSettings:{port:n.port,address:n.address,hints:(n==null?void 0:n.hints)??[],https:!c}})},name:"use_https",id:"use_https",type:"checkbox",style:{width:"20px",height:"20px"}})}),t.jsxs("div",{children:[t.jsx(x,{title:"Hints",subTitle:b.h2_hint}),t.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",justifyContent:"start",marginTop:"4px"},children:[t.jsx(D,{onClick:()=>{var h;y({newBackendSettings:{port:n.port,address:n.address,hints:(h=n==null?void 0:n.hints)!=null&&h.includes(u.H2)?n==null?void 0:n.hints.filter(l=>l!==u.H2):[...(n==null?void 0:n.hints)??[],u.H2],https:c}})},checked:!!((m=n==null?void 0:n.hints)!=null&&m.includes(u.H2)),title:"H2"}),t.jsx(D,{onClick:()=>{var h;y({newBackendSettings:{port:n.port,address:n.address,hints:(h=n==null?void 0:n.hints)!=null&&h.includes(u.H2C)?n==null?void 0:n.hints.filter(l=>l!==u.H2C):[...(n==null?void 0:n.hints)??[],u.H2C],https:c}})},checked:!!((N=n==null?void 0:n.hints)!=null&&N.includes(u.H2C)),title:"H2C"}),t.jsx(D,{onClick:()=>{var h;y({newBackendSettings:{port:n.port,address:n.address,hints:(h=n==null?void 0:n.hints)!=null&&h.includes(u.H2CPK)?n==null?void 0:n.hints.filter(l=>l!==u.H2CPK):[...(n==null?void 0:n.hints)??[],u.H2CPK],https:c}})},checked:!!((F=n==null?void 0:n.hints)!=null&&F.includes(u.H2CPK)),title:"H2CPK"}),t.jsx(D,{onClick:()=>{var h;y({newBackendSettings:{port:n.port,address:n.address,hints:(h=n==null?void 0:n.hints)!=null&&h.includes(u.NOH2)?n==null?void 0:n.hints.filter(l=>l!==u.NOH2):[...(n==null?void 0:n.hints)??[],u.NOH2],https:c}})},checked:!!(($=n==null?void 0:n.hints)!=null&&$.includes(u.NOH2)),title:"NOH2"})]})]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:".5fr 1fr",gap:"10px",marginTop:"5px"}}),t.jsxs(Qe,{className:"flex flex-row gap-4",children:[t.jsx(E,{onClick:async()=>{try{await i.mutateAsync({hostname:e.host_name,siteSettings:{...e,backends:e.backends.filter((h,l)=>l!==a)}}),r()}catch(h){console.error("delete backend error:",h)}},style:{width:"150px",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},dangerButton:!0,children:"Delete"}),t.jsx(Xe,{asChild:!0,children:t.jsx(E,{type:"submit",children:"Close"})})]})]})})):(console.log("null"),null)},Nt=({site:e})=>{var I;const{deleteSite:o,updateRemoteSite:r}=X(),[a,s]=p.useState(e==null?void 0:e.host_name),[i,d]=p.useState(!1),[n,g]=p.useState({backend:void 0,show:!1,listIndex:-1});p.useEffect(()=>{g(c=>({...c,backends:e.backends}))},[e]);const j=re(),v=(c,y)=>{let m=Array.isArray(y)||isNaN(y)===!1?y:`${y}`;Y.promise(r.mutateAsync({hostname:e.host_name,siteSettings:{...e,[c]:m}}),{loading:`Updating settings.. [${e.host_name}]`,success:`Settings updated! [${e.host_name}]`,error:N=>`${N}`})};return t.jsxs("div",{style:{paddingBottom:"50px",maxWidth:"750px"},onSubmit:c=>{c.preventDefault()},children:[t.jsx(T,{noTopSeparator:!0,children:t.jsx(x,{title:"Hostname",subTitle:b.hostname_frontend,children:t.jsx(w,{originalValue:e.host_name,onSave:c=>{v("host_name",c)},withSaveButton:!0,value:a,onChange:c=>s(c.target.value)})})}),t.jsxs(T,{noTopSeparator:!0,children:[t.jsx(x,{labelFor:"capture_subdomains",rowOnly:!0,title:"Capture sub-domains",subTitle:b.capture_subdomains,children:t.jsx(w,{onChange:()=>{v("capture_subdomains",!e.capture_subdomains)},checked:!!e.capture_subdomains,type:"checkbox",name:"capture_subdomains",id:"capture_subdomains",style:{width:"20px",height:"20px"}})}),t.jsx(x,{rowOnly:!0,labelFor:"disable_tcp_tunnel",title:"Disable TCP tunnel mode",subTitle:b.disable_tcp_tunnel,children:t.jsx(w,{type:"checkbox",checked:!!e.disable_tcp_tunnel_mode,onChange:()=>{v("disable_tcp_tunnel_mode",!e.disable_tcp_tunnel_mode)},id:"disable_tcp_tunnel",name:"disable_tcp_tunnel",style:{width:"20px",height:"20px"}})}),t.jsx(x,{rowOnly:!0,labelFor:"forward_subdomains",title:"Forward sub-domains",subTitle:b.forward_subdomains,children:t.jsx(w,{type:"checkbox",checked:!!e.forward_subdomains,onChange:()=>{v("forward_subdomains",!e.forward_subdomains)},id:"forward_subdomains",name:"forward_subdomains",style:{width:"20px",height:"20px"}})})]}),t.jsxs(T,{noTopSeparator:!0,children:[t.jsx(x,{title:"Backends",subTitle:b.backends}),t.jsxs("div",{style:{background:"var(--color3)",color:"black",marginTop:"10px",borderRadius:"5px",overflow:"hidden"},children:[(I=e.backends)==null?void 0:I.map((c,y)=>t.jsx("div",{onClick:()=>{g({backend:c,show:!0,listIndex:y})},className:"env-var-item",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px"},children:t.jsx("p",{style:{zIndex:1,fontSize:".8rem"},children:c.address})},JSON.stringify({backend:c,index:y}))),t.jsx("div",{onClick:()=>{r.mutateAsync({hostname:e.host_name,siteSettings:{...e,backends:[...e.backends,{address:"NEW_BACKEND",port:8080,hints:[],https:!1}]}})},className:"env-var-item",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px"},children:t.jsxs("div",{style:{zIndex:1,fontSize:".8rem",display:"flex",alignItems:"center",gap:"5px"},children:[t.jsx(Ct,{}),"New backend"]})})]})]}),t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"end",marginTop:"20px"},children:t.jsx(E,{onClick:()=>{d(!0)},style:{width:"max-content"},dangerButton:!0,children:"Delete site"})}),t.jsx(Ce,{show:i,onClose:()=>d(!1),title:"Delete",subtitle:`Are you sure you want to delete the site '${e.host_name}'?`,children:t.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"10px"},children:[t.jsx(E,{secondary:!0,onClick:()=>d(!1),children:"Cancel"}),t.jsx(E,{onClick:()=>{o.mutateAsync({hostname:e.host_name},{onSuccess:()=>{d(!1),j.navigate({to:"/"})}})},dangerButton:!0,children:"Yes, delete"})]})},e.host_name),t.jsx(Tt,{listIndex:n.listIndex,site:e,show:n.show,onClose:()=>g(c=>({...c,show:!1}))},JSON.stringify(n.backend))]},e.host_name)},kt=({hostedProcess:e,remoteSite:o})=>e?t.jsx(_t,{site:e}):o?t.jsx(Nt,{site:o}):t.jsx("p",{children:"Site not found"}),At=({sections:e})=>{const o=re(),a=new URLSearchParams(window.location.search).get("tab"),[s,i]=p.useState(Number(a)??0);return t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{display:"flex",gap:"20px",marginTop:"20px"},children:e==null?void 0:e.map((d,n)=>t.jsx(Ot,{active:s===n,onClick:()=>{o.navigate({search:{tab:n}}),i(n)},title:d.name},n))}),t.jsx("div",{style:{height:"1px",width:"100%",background:"#ffffff44",marginTop:"-1px",marginBottom:"20px"}}),e==null?void 0:e[s].content]})},Ot=({active:e,title:o,onClick:r})=>t.jsx("div",{style:{color:e?"var(--color2)":"#fff",cursor:"pointer",borderBottom:e?"1px solid var(--color2)":0},onClick:r,children:o}),Ht=()=>{const{data:e}=Ke(),{data:o}=be(),r=We({from:"/site/$siteName"}),a=e.find(d=>d.host_name.replaceAll("http://","").replaceAll("https://","")===r.siteName),s=o.find(d=>d.host_name.replaceAll("http://","").replaceAll("https://","")===r.siteName);if(!a&&!s)return t.jsx("p",{children:"site not found"});const i=[];return a&&i.push({name:"Overview",content:t.jsx(nt,{hostedProcess:a,remoteSite:s})}),i.push({name:"Settings",content:t.jsx(kt,{hostedProcess:a,remoteSite:s})}),a&&i.push({name:"Log",content:t.jsx(ze,{hostedProcess:a,remoteSite:s})}),t.jsxs("div",{children:[t.jsx("p",{style:{textTransform:"uppercase",fontSize:".9rem",fontWeight:"bold",color:"var(--color2)"},children:r.siteName}),t.jsx(At,{sections:i},(a==null?void 0:a.host_name)??(s==null?void 0:s.host_name))]})},Dt=Ve("/site/$siteName")({component:Ht});export{Dt as Route};
