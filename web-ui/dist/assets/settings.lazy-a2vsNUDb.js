import{A as P,u as V,a as E,b as L,c as A,r as i,e as x,j as t,C as B,d as k,f as D,g as I,h as R,S as l,i as r,k as n,I as s,L as F,l as U,_ as M,m as O}from"./index-B1JzGk6e.js";const $=()=>{let u=window.location.protocol+"//"+window.location.hostname;window.location.port&&(u=`${u}:${window.location.port}`);const c=u,a=new P({baseUrl:c}),p=V();return{updateSettings:E({mutationKey:["update-settings"],mutationFn:a.api.saveSettings,onSettled:()=>{p.invalidateQueries({queryKey:["settings"]})}})}},q=()=>{const{lightMode:u}=L(),{updateSettings:c}=$(),{data:a}=A(),[p,g]=i.useState(a.ip),[v,m]=i.useState(a.lets_encrypt_account_email),[S,_]=i.useState(a.root_dir),[j,b]=i.useState(a.http_port),[h,w]=i.useState(x(a.env_vars??[])),[y,T]=i.useState(a.tls_port),[f,N]=i.useState(a.port_range_start),o=(e,d)=>{let C=Array.isArray(d)||isNaN(d)===!1?d:`${d}`;M.promise(c.mutateAsync({...a,[e]:C}),{loading:"Updating settings..",success:"Settings updated!",error:"Failed to update settings"})};return t.jsx("main",{className:"grid flex-1 items-start gap-4 sm:py-0 md:gap-8 max-w-[900px]",children:t.jsxs(B,{children:[t.jsxs(k,{children:[t.jsx(D,{children:"Settings"}),t.jsx(I,{children:"General settings that affect all sites"})]}),t.jsxs(R,{children:[t.jsx(l,{marginTop:"0px",noTopSeparator:!0,noBottomSeparator:!0,children:t.jsx(r,{title:"Root directory",subTitle:n.root_dir,children:t.jsx(s,{withSaveButton:!0,onSave:e=>{o("root_dir",e)},type:"text",originalValue:a.root_dir,value:S,onChange:e=>_(e.target.value)})})}),t.jsxs(l,{children:[t.jsx(r,{title:"HTTP Port",subTitle:n.default_http_port,defaultValue:"8080",children:t.jsx(s,{value:j,withSaveButton:!0,originalValue:a.http_port,onSave:e=>{o("http_port",e)},onChange:e=>{isNaN(Number(e.target.value))||b(Number(e.target.value))}})}),t.jsx(r,{title:"TLS Port",subTitle:n.default_tls_port,defaultValue:"4343",children:t.jsx(s,{value:y,originalValue:a.tls_port,withSaveButton:!0,onSave:e=>{o("tls_port",e)},onChange:e=>{isNaN(Number(e.target.value))||T(Number(e.target.value))}})}),t.jsx(r,{title:"IP Address",subTitle:n.proxy_ip,children:t.jsx(s,{value:p,originalValue:a.ip,withSaveButton:!0,onSave:e=>{o("ip",e)},onChange:e=>g(e.target.value)})})]}),t.jsxs(l,{noTopSeparator:!0,children:[t.jsx(r,{title:"Port range start",subTitle:n.port_range_start,children:t.jsx(s,{value:f,originalValue:a.port_range_start,withSaveButton:!0,onSave:e=>o("port_range_start",e),onChange:e=>{isNaN(Number(e.target.value))||N(Number(e.target.value))}})}),t.jsx(r,{title:"Use ALPN",labelFor:"alpn",subTitle:n.use_alpn,rowOnly:!0,children:t.jsx(s,{type:"checkbox",id:"alpn",checked:a.alpn,onChange:()=>o("alpn",!a.alpn),style:{width:"20px",height:"20px"}})})]}),t.jsx(l,{noTopSeparator:!0,children:t.jsx(r,{title:"Autostart",rowOnly:!0,subTitle:n.default_auto_start,labelFor:"autostart",children:t.jsx(s,{id:"autostart",type:"checkbox",checked:a.auto_start,onChange:()=>o("auto_start",!a.auto_start),style:{width:"20px",height:"20px"}})})}),t.jsxs(l,{noTopSeparator:!0,children:[t.jsx(r,{title:"Log level",subTitle:n.log_level,children:t.jsxs("select",{className:"text-black rounded pl-3 pr-3 bg-white border border-[var(--border)]",value:a.log_level,onChange:e=>{o("log_level",e.target.value)},name:"loglevel",style:{height:"32px",width:"100%"},children:[t.jsx("option",{value:"Trace",children:"Trace"}),t.jsx("option",{value:"Debug",children:"Debug"}),t.jsx("option",{value:"Info",children:"Info"}),t.jsx("option",{value:"Warn",children:"Warn"}),t.jsx("option",{value:"Error",children:"Error"})]})}),t.jsx(r,{title:"Log format",subTitle:n.default_log_format,children:t.jsxs("select",{className:"text-black rounded pl-3 pr-3 border bg-white border-[var(--border)]",value:a.default_log_format??F.Standard,onChange:e=>{o("default_log_format",e.target.value)},name:"log_format",style:{height:"32px",width:"100%"},children:[t.jsx("option",{value:"Standard",children:"Standard"}),t.jsx("option",{value:"Dotnet",children:"Dotnet"})]})})]}),t.jsx(l,{marginTop:"0px",noTopSeparator:!0,noBottomSeparator:!0,children:t.jsx(r,{title:"Lets Encrypt account email",subTitle:n.lets_encrypt_account_email,children:t.jsx(s,{withSaveButton:!0,onSave:e=>{o("lets_encrypt_account_email",e)},type:"text",originalValue:a.lets_encrypt_account_email,value:v,onChange:e=>m(e.target.value)})})}),t.jsx(r,{vertical:!0,title:"Environment variables",subTitle:"Semicolon separated list of environment variables to be set on oddbox start.",children:t.jsx(s,{withSaveButton:!0,disableSaveButton:c.isPending,originalValue:x(a.env_vars??[]),value:h,onSave:()=>{o("env_vars",U(h))},onChange:e=>{w(e.target.value)}})}),t.jsx(l,{noTopSeparator:!0,noBottomSeparator:!0,children:t.jsx(r,{title:"Light mode",rowOnly:!0,subTitle:"Use an experimental light mode",labelFor:"lightmode",children:t.jsx(s,{id:"lightmode",type:"checkbox",checked:u,onChange:()=>document.body.classList.toggle("light"),style:{width:"20px",height:"20px"}})})})]})]})})},K=O("/settings")({component:q});export{K as Route};
