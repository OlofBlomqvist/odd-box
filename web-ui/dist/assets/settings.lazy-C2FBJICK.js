import{A as f,u as N,a as T,b as C,r as u,j as t,C as P,c as E,d as k,e as A,f as L,S as c,g as n,h as s,I as l,L as R,E as V,_ as B,i as D}from"./index-D8ZJl6Ku.js";const I=()=>{let p=window.location.protocol+"//"+window.location.hostname;window.location.port&&(p=`${p}:${window.location.port}`);const a=p,d=new f({baseUrl:a}),g=N();return{updateSettings:T({mutationKey:["update-settings"],mutationFn:d.api.saveSettings,onSettled:()=>{g.invalidateQueries({queryKey:["settings"]})}})}},F=()=>{const{updateSettings:p}=I(),{data:a}=C(),[d,g]=u.useState(a.ip),[h,v]=u.useState(a.lets_encrypt_account_email),[x,_]=u.useState(a.root_dir),[m,S]=u.useState(a.http_port),[j,y]=u.useState(a.tls_port),[w,b]=u.useState(a.port_range_start),r=(e,o)=>{let i=Array.isArray(o)||isNaN(o)===!1?o:`${o}`;B.promise(p.mutateAsync({...a,[e]:i}),{loading:"Updating settings..",success:"Settings updated!",error:"Failed to update settings"})};return t.jsx("main",{className:"grid flex-1 items-start gap-4 sm:py-0 md:gap-8 max-w-[900px]",children:t.jsxs(P,{className:"mb-8",children:[t.jsxs(E,{children:[t.jsx(k,{children:"Settings"}),t.jsx(A,{children:"General settings that affect all sites"})]}),t.jsxs(L,{children:[t.jsx(c,{marginTop:"0px",noTopSeparator:!0,noBottomSeparator:!0,children:t.jsx(n,{title:"Root directory",subTitle:s.root_dir,children:t.jsx(l,{withSaveButton:!0,onSave:e=>{r("root_dir",e)},type:"text",originalValue:a.root_dir,value:x,onChange:e=>_(e.target.value)})})}),t.jsxs(c,{children:[t.jsx(n,{title:"HTTP Port",subTitle:s.default_http_port,defaultValue:"8080",children:t.jsx(l,{value:m,withSaveButton:!0,originalValue:a.http_port,onSave:e=>{r("http_port",e)},onChange:e=>{isNaN(Number(e.target.value))||S(Number(e.target.value))}})}),t.jsx(n,{title:"TLS Port",subTitle:s.default_tls_port,defaultValue:"4343",children:t.jsx(l,{value:j,originalValue:a.tls_port,withSaveButton:!0,onSave:e=>{r("tls_port",e)},onChange:e=>{isNaN(Number(e.target.value))||y(Number(e.target.value))}})}),t.jsx(n,{title:"IP Address",subTitle:s.proxy_ip,children:t.jsx(l,{value:d,originalValue:a.ip,withSaveButton:!0,onSave:e=>{r("ip",e)},onChange:e=>g(e.target.value)})})]}),t.jsxs(c,{noTopSeparator:!0,children:[t.jsx(n,{title:"Port range start",subTitle:s.port_range_start,children:t.jsx(l,{value:w,originalValue:a.port_range_start,withSaveButton:!0,onSave:e=>r("port_range_start",e),onChange:e=>{isNaN(Number(e.target.value))||b(Number(e.target.value))}})}),t.jsx(n,{title:"Use ALPN",labelFor:"alpn",subTitle:s.use_alpn,rowOnly:!0,children:t.jsx(l,{type:"checkbox",id:"alpn",checked:a.alpn,onChange:()=>r("alpn",!a.alpn),style:{width:"20px",height:"20px"}})})]}),t.jsx(c,{noTopSeparator:!0,children:t.jsx(n,{title:"Autostart",rowOnly:!0,subTitle:s.default_auto_start,labelFor:"autostart",children:t.jsx(l,{id:"autostart",type:"checkbox",checked:a.auto_start,onChange:()=>r("auto_start",!a.auto_start),style:{width:"20px",height:"20px"}})})}),t.jsxs(c,{noTopSeparator:!0,children:[t.jsx(n,{title:"Log level",subTitle:s.log_level,children:t.jsxs("select",{className:"text-black rounded pl-3 pr-3",value:a.log_level,onChange:e=>{r("log_level",e.target.value)},name:"loglevel",style:{height:"32px",width:"100%"},children:[t.jsx("option",{value:"Trace",children:"Trace"}),t.jsx("option",{value:"Debug",children:"Debug"}),t.jsx("option",{value:"Info",children:"Info"}),t.jsx("option",{value:"Warn",children:"Warn"}),t.jsx("option",{value:"Error",children:"Error"})]})}),t.jsx(n,{title:"Log format",subTitle:s.default_log_format,children:t.jsxs("select",{className:"text-black rounded pl-3 pr-3",value:a.default_log_format??R.Standard,onChange:e=>{r("default_log_format",e.target.value)},name:"log_format",style:{height:"32px",width:"100%"},children:[t.jsx("option",{value:"Standard",children:"Standard"}),t.jsx("option",{value:"Dotnet",children:"Dotnet"})]})})]}),t.jsx(c,{marginTop:"0px",noTopSeparator:!0,noBottomSeparator:!0,children:t.jsx(n,{title:"Lets Encrypt account email",subTitle:s.lets_encrypt_account_email,children:t.jsx(l,{withSaveButton:!0,onSave:e=>{r("lets_encrypt_account_email",e)},type:"text",originalValue:a.lets_encrypt_account_email,value:h,onChange:e=>v(e.target.value)})})}),t.jsx(n,{vertical:!0,title:"Environment variables",subTitle:s.global_env_vars,children:t.jsx(V,{keys:a.env_vars??[],onRemoveKey:e=>{var o;r("env_vars",(o=a.env_vars)==null?void 0:o.filter(i=>i.key!==e))},onNewKey:(e,o)=>{r("env_vars",[...a.env_vars.filter(i=>i.key!==e.key&&i.key!==o),{key:e.key,value:e.value}])}})})]})]})})},U=D("/settings")({component:F});export{U as Route};
